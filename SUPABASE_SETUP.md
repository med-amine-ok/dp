# Supabase Setup Guide for DP Kid

This guide will help you migrate your local mock data and schema to a real Supabase PostgreSQL database.

## Prerequisites

1.  A [Supabase](https://supabase.com/) project created.
2.  Access to the SQL Editor in your Supabase dashboard.

## Step 1: Create the Database Schema

1.  Open your Supabase Project Dashboard.
2.  Go to the **SQL Editor** (icon looking like a query `>_` on the left).
3.  Click **New Query**.
4.  Copy the content of `supabase/schema.sql` from your project.
5.  Paste it into the SQL Editor and click **Run**.

This will create all the necessary tables:
*   `profiles` (linked to Auth)
*   `patients` & `doctors`
*   `dialysis_sessions`
*   `health_reports`
*   `videos` & `video_progress`
*   `games` & `game_sessions`
*   `chat_messages`
*   `fun_facts`

And set up Row Level Security (RLS) policies so data is secure.

## Step 2: Seed Initial Data

1.  In the SQL Editor, click **New Query**.
2.  Copy the content of `supabase/seed.sql`.
3.  Paste it into the SQL Editor and click **Run**.

**Important Note on Authentication:**
The seed script creates dummy patient and doctor profiles with hardcoded IDs (e.g., `...0000d1` for Doctor 1).
*   These profiles are **not** automatically linked to real login accounts yet.
*   To log in as "Ahmed Mohamed" or "Dr. Karim", you will need to:
    1.  Create a user in the **Authentication** tab in Supabase (e.g., `ahmed@dpkid.com`).
    2.  Copy the `User UID` generated by Supabase.
    3.  Update the `profiles` table to match this new UID:
        ```sql
        UPDATE public.profiles SET id = 'NEW_UID_HERE' WHERE id = '00000000-0000-0000-0000-0000000000p1';
        UPDATE public.patients SET id = 'NEW_UID_HERE' WHERE id = '00000000-0000-0000-0000-0000000000p1';
        ```
    4.  (Or simply create new users and start fresh!)

## Step 3: Connect Your App

1.  Copy your `SUPABASE_URL` and `SUPABASE_ANON_KEY` from Project Settings -> API.
2.  Create a `.env` file in your project root:
    ```
    VITE_SUPABASE_URL=your_supabase_url
    VITE_SUPABASE_ANON_KEY=your_supabase_anon_key
    ```
3.  Update your `src/lib/supabase.ts` (or create it) to initialize the client.
4.  Replace mock data calls in your components with Supabase queries.

## Table Structure Overview

*   **Patients**: Stores medical details, status, and assigned doctor.
*   **Dialysis Sessions**: Tracks weight, duration, and BP for every session.
*   **Health Reports**: Daily forms submitted by patients (Mood, Symptoms, etc.).
*   **Videos & Games**: Content libraries for the educational section.
